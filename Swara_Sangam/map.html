
<html>
	<head>
    <title>Your First API Call</title>
    <link href="http://www.stackmob.com/platform/favicon.ico" type="image/vnd.microsoft.icon" rel="icon" />
    <link href="http://www.stackmob.com/platform/favicon.png" type="image/png" rel="icon" />
    <link rel="stylesheet" href="index.css" />
    <style type="text/css" media="screen">
      /* <![CDATA[ */
        li { padding-top: 10px; }
      /* ]]> */
    </style>
		<!--
		*************************************
		STACKMOB JS SDK DEPENDENCIES
		Include these in your pages where you want to use the StackMob js sdk
		*************************************
		-->
		<script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/1.8.2/jquery.min.js"></script>
		<script type="text/javascript" src="http://static.stackmob.com/js/stackmob-js-0.8.0-bundled-min.js"></script>
		<script src="https://maps.googleapis.com/maps/api/js?v=3.exp&sensor=false&libraries=demo_schema1"></script>
		<!--
		*************************************
		INITIALIZE THE JS SDK BELOW

		Copy/Paste the init method from:
		https://dashboard.stackmob.com/sdks/js/config
		*************************************
		-->
		<script type="text/javascript">
      /* <![CDATA[ */
      // Initialize StackMob object
      // Copy your init data from here: https://dashboard.stackmob.com/sdks/js/config
      // Your other app information is here: https://dashboard.stackmob.com/settings
      StackMob.init({
    appName: "swara_sangam",
    clientSubdomain: "ankitguptamixorgcom",
    publicKey: "a21c4638-f221-4a70-925b-65cc30de4c30",
    apiVersion: 0
});
	  
      /* ]]> */
</script>
      
		</script>

		<!--
		*************************************
		StackMob JS SDK code that creates and saves a TestObject
		*************************************
		-->
		<script type="text/javascript">
      /* <![CDATA[ */
      $(document).ready(function() {				
	  		var media = StackMob.Model.extend({ schemaName: 'media' });
			var media = new media({  });
					var q = new StackMob.Collection.Query();
					q.orderDesc('lastmoddate');
					media.query(q, {
						success: function(modal) {
							//After StackMob returns "Bill Watterson", print out the result
						   	var array = modal.toJSON();
							 // console.debug(array);
							  var val = array[0].media_lat.lat+","+array[0].media_lang.lon;
							$('#latlng').attr('value', val);
							initialize();
						}
				 	 });
					 
		// If your schema name is different than `place`, then you need to replace `place` with your schema
		
	  		var geocoder;
			  var map;
			  var marker;
		
			 function initialize() {
			  
			geocoder = new google.maps.Geocoder();
			
			var input = document.getElementById("latlng").getAttribute("value"); 
		   //alert(input);
			var latlngStr = input.split(",",2);
			var media_lat = parseFloat(latlngStr[0]);
			var media_lang = parseFloat(latlngStr[1]);
			var latlng = new google.maps.LatLng(media_lat, media_lang);
			geocoder.geocode({'latLng': latlng}, function(results, status) {
			  //var address = results[4].formatted_address;
			  var address = results[0].formatted_address;
			$("#test").html(address);
		//	console.log(results[4].formatted_address);
		geocoder.geocode( { 'address': address}, function(results, status) {
			  if (status == google.maps.GeocoderStatus.OK) {
				map.setCenter(results[0].geometry.location);
				var marker = new google.maps.Marker({
					map: map,
					position: results[0].geometry.location
				});
			  } else {
				alert("Geocode was not successful for the following reason: " + status);
			  }
			});
		   });
			var mapOptions = {
			  zoom: 3,
			  center: new google.maps.LatLng(37.4419, -22.1419),
			  mapTypeId: google.maps.MapTypeId.TERRAIN,
			  mapTypeControl: false,
			  streetViewControl: false
		 
			}
			map = new google.maps.Map(document.getElementById("map_canvas"), mapOptions);
			
		  }
		   
		  /*function codeLatLng() {
			  
		   var input = document.getElementById("latlng").getAttribute("value"); 
		   //alert(input);
			var latlngStr = input.split(",",2);
			var lat = parseFloat(latlngStr[0]);
			var lng = parseFloat(latlngStr[1]);
			var latlng = new google.maps.LatLng(lat, lng);
			geocoder.geocode({'latLng': latlng}, function(results, status) {
			  
			$("#test").append(results[4].formatted_address);
			console.log(results[4].formatted_address);
			});
		
			
		  } */ 
  	
	});

     
      /* ]]> */
		</script>
  <body>
  <div class="data"></div>
  
   <div id="latlng" value=""></div>
<div id="test" style='height:50px;'></div>
<div id="map_canvas"  style="width: 97%; height: 85%; border: 1px solid black"></div>  

	</body>
</html>
